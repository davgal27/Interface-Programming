<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="clr-namespace:WPFWeather.App.Converters"
    xmlns:viewModels="clr-namespace:WPFWeather.App.ViewModels"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    x:Class="WPFWeather.App.Windows.MainWindow"
    mc:Ignorable="d"
    Title="WPF Weather Demo" Height="312" Width="500"
    d:DataContext="{d:DesignInstance {x:Type viewModels:WeatherViewModel}}">

    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="boolToVisibilityConverter" />
    </Window.Resources>

    <!-- Main Grid Layout -->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" MinWidth="50" />
            <ColumnDefinition Width="*" MinWidth="50" />
            <ColumnDefinition Width="*" MinWidth="50" />
            <ColumnDefinition Width="*" MinWidth ="50"  />
        </Grid.ColumnDefinitions>


        <!-- COLOUMN 0: CITY NAME AND SELECTOR-->
        <StackPanel Grid.Column="0" Margin="10" VerticalAlignment="Top">
            <!-- City name -->
            <Viewbox Stretch="Uniform" Height="35" Margin="0,0,0,8">
                <TextBlock Text="{Binding Weather.CityName}" FontWeight="Bold"/>
            </Viewbox>

            <!-- input for city -->
            <TextBox x:Name="CityTextBox"
             Text="{Binding SearchCity, UpdateSourceTrigger=PropertyChanged}"
             HorizontalAlignment="Stretch"
             MinWidth="50"
             Margin="0,0,0,4"/>

            <!-- Button of city  -->
            <Button Content="Get Weather"
            Command="{Binding DownloadWeatherCommand}"
            CommandParameter="{Binding Text, ElementName=CityTextBox}"
            HorizontalAlignment="Stretch"
            MinWidth="50"/>
        </StackPanel>
        
        <!-- COLOUMN 1: WEATHER ICON, DESC, AND TEMP-->   
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="2*"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <!-- Weather description -->
            <TextBlock Grid.Row="0"
               Text="{Binding Weather.Description}" 
               FontSize="32" 
               FontStyle="Italic"
               FontWeight="Bold"
               TextAlignment="Center"
               VerticalAlignment="Center"
               TextWrapping="Wrap"/>

            <!-- icon -->
            <Image Grid.Row="1"
                Source="{Binding Weather.Icon}" 
                Width="100" 
                Height="100" 
                HorizontalAlignment="Center"
                VerticalAlignment="Center"/>

            <!-- Temp -->
            <TextBlock Grid.Row="2"
               Text="{Binding Weather.Temperature, StringFormat={}{0:0}°C}" 
               FontSize="32" 
               FontWeight="Bold"
               TextAlignment="Center"
               VerticalAlignment="Center"/>
        </Grid>
        
        <!-- COLUMN 2: WIND -->
        <Grid Grid.Column="2" Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="3*" />
            </Grid.RowDefinitions>

            <!-- Wind arrow -->
            <Viewbox Grid.Row="0" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Polygon Fill="Black">
                    <Polygon.LayoutTransform>
                        <RotateTransform Angle="{Binding Weather.WindDirection}"/>
                    </Polygon.LayoutTransform>
                    <Polygon.Points>
                        <Point X="15" Y="0"/>
                        <Point X="10" Y="30"/>
                        <Point X="20" Y="30"/>
                    </Polygon.Points>
                </Polygon>
            </Viewbox>

            <!-- Wind speed -->
            <TextBlock Grid.Row="1"
               Text="{Binding Weather.WindSpeed, StringFormat={}{0:0} m/s}"
               FontSize="20"
               FontWeight="Bold"
               HorizontalAlignment="Center"
               VerticalAlignment="Center"/>
        </Grid>
        
       
        <!-- COLOUMN 3: HUMIDITY-->
        <Grid Grid.Column="3" Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Viewbox Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center">
                <TextBlock Text="{Binding Weather.Humidity, StringFormat=Humidity: {0}%}"
                   FontSize="24"
                   FontWeight="Bold"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"/>
            </Viewbox>
        </Grid>
        
        <!-- Make coloumns visble-->
        <Rectangle Grid.Column="0" Grid.ColumnSpan="1" HorizontalAlignment="Right" Width="3" Fill="Gray"/>
        <Rectangle Grid.Column="1" Grid.ColumnSpan="1" HorizontalAlignment="Right" Width="3" Fill="Gray"/>
        <Rectangle Grid.Column="2" Grid.ColumnSpan="1" HorizontalAlignment="Right" Width="3" Fill="Gray"/>

    </Grid>
    
    <!-- Background -->
    <Window.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="Gray" Offset="0"/>
            <GradientStop Color="White" Offset="1"/>
        </LinearGradientBrush>
    </Window.Background>
    
</Window>